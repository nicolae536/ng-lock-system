{"version":3,"file":"lock.component.base.js","sourceRoot":"","sources":["../../src/lock.component.base.ts"],"names":[],"mappings":";;;;;;;;;AAEA,OAAO,EAAE,cAAc,EAAE,MAAM,cAAc,CAAC;AAC9C,OAAO,EAAE,kBAAkB,EAAE,MAAM,wBAAwB,CAAC;AAC5D,OAAO,EAAE,WAAW,EAAE,MAAM,gBAAgB,CAAC;AAC7C,OAAO,EAAE,kBAAkB,EAAE,MAAM,uBAAuB,CAAC;AAE3D;IAUI;QATU,SAAI,GAAgB,IAAI,CAAC;QACzB,cAAS,GAAwB,IAAI,CAAC;QACtC,aAAQ,GAAY,KAAK,CAAC;QAE5B,iBAAY,GAAW,EAAE,CAAC;QAC1B,iBAAY,GAAuB,IAAI,CAAC;QACxC,sBAAiB,GAAiB,IAAI,CAAC;QACvC,mBAAc,GAAmB,EAAE,CAAC;QAGxC,IAAI,CAAC,IAAI,GAAG,kBAAkB,CAAC,QAAQ,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;QACzD,IAAI,CAAC,YAAY,GAAG,kBAAkB,CAAC,QAAQ,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;QACxE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC,CAAC;IAC3C,CAAC;IAED,4CAAc,GAAd,UAAe,WAAmB;QAC9B,IAAI,CAAC,YAAY,GAAG,WAAW,CAAC;QAChC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;IACnE,CAAC;IAED,oDAAsB,GAAtB;QAAA,iBAUC;QATG,EAAE,CAAC,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC;YACzB,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;QACvD,CAAC;QAED,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC;YAC/C,MAAM,CAAC;QACX,CAAC;QAED,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,UAAA,QAAQ,IAAI,OAAA,KAAI,CAAC,QAAQ,GAAG,QAAQ,EAAxB,CAAwB,CAAC,CAAC;IAC5F,CAAC;IAED,yCAAW,GAAX,UAAY,KAAqB;QAArB,sBAAA,EAAA,YAAqB;QAC7B,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;IAC5B,CAAC;IAED,kCAAI,GAAJ,UAAK,KAAqB,EAAE,WAA4B;QAAnD,sBAAA,EAAA,YAAqB;QAAE,4BAAA,EAAA,mBAA4B;QACpD,KAAK;cACC,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,IAAI,CAAC,YAAY,EAAE,WAAW,CAAC;cAC7D,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;IAC7D,CAAC;IAED,6CAAe,GAAf,UAAgB,CAAe;QAC3B,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;IAChC,CAAC;IAGD,yCAAW,GAAX;QACI,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;QACnD,IAAI,CAAC,YAAY,CAAC,eAAe,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;QACrD,IAAI,CAAC,YAAY,CAAC,QAAQ,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC;IACpD,CAAC;IAJD;QADC,cAAc,EAAE;;;;0DAKhB;IACL,0BAAC;CAAA,AArDD,IAqDC;SArDY,mBAAmB","sourcesContent":["import { Observable } from \"rxjs/Observable\";\r\nimport { Subscription } from \"rxjs/Subscription\";\r\nimport { AfterOnDestroy } from \"./decorators\";\r\nimport { LockManagerService } from \"./lock-manager.service\";\r\nimport { UtilService } from \"./util.service\";\r\nimport { RootServiceLocator } from \"./root.injector.const\";\r\n\r\nexport class NgLockComponentBase {\r\n    protected util: UtilService = null;\r\n    protected isLocked$: Observable<boolean> = null;\r\n    protected isLocked: boolean = false;\r\n\r\n    private _componentId: string = \"\";\r\n    private _lockManager: LockManagerService = null;\r\n    private _lockSubscription: Subscription = null;\r\n    private _subscriptions: Subscription[] = [];\r\n\r\n    constructor() {\r\n        this.util = RootServiceLocator.injector.get(UtilService);\r\n        this._lockManager = RootServiceLocator.injector.get(LockManagerService);\r\n        this.setComponentId(this.util.getId());\r\n    }\r\n\r\n    setComponentId(componentId: string) {\r\n        this._componentId = componentId;\r\n        this.isLocked$ = this._lockManager.listenTo(this._componentId);\r\n    }\r\n\r\n    unWrapLockSubscription() {\r\n        if (this._lockSubscription) {\r\n            this._lockManager.unListen(this._lockSubscription);\r\n        }\r\n\r\n        if (!this.isLocked$ || !this.isLocked$.subscribe) {\r\n            return;\r\n        }\r\n\r\n        this._lockSubscription = this.isLocked$.subscribe(isLocked => this.isLocked = isLocked);\r\n    }\r\n\r\n    busyManager(value: boolean = true) {\r\n        this.busy(value, value);\r\n    }\r\n\r\n    busy(value: boolean = true, managerBusy: boolean = false) {\r\n        value\r\n            ? this._lockManager.lockManager(this._componentId, managerBusy)\r\n            : this._lockManager.unlockManager(this._componentId);\r\n    }\r\n\r\n    addSubscription(s: Subscription) {\r\n        this._subscriptions.push(s);\r\n    }\r\n\r\n    @AfterOnDestroy()\r\n    cleanupData() {\r\n        this._lockManager.unListen(this._lockSubscription);\r\n        this._lockManager.removeComponent(this._componentId);\r\n        this._lockManager.unListen(this._subscriptions);\r\n    }\r\n}\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}